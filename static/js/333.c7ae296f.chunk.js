"use strict";(self.webpackChunkcnam=self.webpackChunkcnam||[]).push([[333],{5413:function(e,t,n){n.r(t);var i=n(9439),r=n(2791),a=n(4554),l=n(3239),o=n(7689),s=n(4957),c=(n(5580),n(5985)),u=n(97),d=n.n(u),h=n(428),f=n(3585),p=n(184);t.default=function(){var e,t,n,u,g,v,m=(0,o.s0)(),y=JSON.parse(sessionStorage.getItem("response")),b=JSON.parse(sessionStorage.getItem("auth")),x=(0,r.useState)(""),j=(0,i.Z)(x,2),C=j[0],S=j[1],k=(0,r.useState)(!1),Z=(0,i.Z)(k,2),T=Z[0],D=Z[1],w=(0,r.useRef)(null),F=(0,r.useState)(""),I=(0,i.Z)(F,2),N=I[0],O=I[1],R=(0,r.useState)(!1),J=(0,i.Z)(R,2),A=J[0],B=J[1],P=(0,r.useRef)(null),M=r.useState({}),q=(0,i.Z)(M,2),_=q[0],E=(q[1],r.useState([])),G=(0,i.Z)(E,2),z=(G[0],G[1]),L=r.useCallback((function(e){return z(e.filter((function(e){return"videoinput"===e.kind})))}),[z]),U=(0,r.useCallback)((function(){var e=P.current.cropper.getCroppedCanvas().toDataURL("image/jpeg",1);S(e)}),[]),V=(0,r.useCallback)((function(){O(w.current.getScreenshot())}),[w]),H=(0,r.useState)(""),K=(0,i.Z)(H,2);K[0],K[1];(0,r.useEffect)((function(){200==(null===y||void 0===y?void 0:y.statusCode)&&null!==y&&void 0!==y&&y.statusCode||m("/")}),[null===y||void 0===y?void 0:y.statusCode]),(0,r.useEffect)((function(){!0===(null===b||void 0===b?void 0:b.verificationResult)&&m(null===f.yy||void 0===f.yy?void 0:f.yy.dashboard)}),[null===b||void 0===b?void 0:b.verificationResult]);return(0,r.useEffect)((function(){navigator.mediaDevices.enumerateDevices().then(L)}),[L]),(0,p.jsx)("div",{children:(0,p.jsx)("div",{className:"d-flex justify-content-center align-items-center",id:"contentContainer",children:(0,p.jsx)("div",{id:"containerRight",children:A?(0,p.jsx)(a.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,p.jsx)(l.Z,{color:"info"})}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.Z,{display:"flex",flexDirection:"row",alignContent:"center",justifyContent:"center",height:"20.9rem",width:"100%",marginTop:"2rem",children:null!==N&&void 0!==N&&N.length?(0,p.jsx)(a.Z,{marginTop:".5rem",children:T&&null!==C&&void 0!==C&&C.length?(0,p.jsx)("img",{alt:"sda",style:{width:null===P||void 0===P||null===(e=P.current)||void 0===e||null===(t=e.cropper)||void 0===t||null===(n=t.cropBoxData)||void 0===n?void 0:n.width,height:null===P||void 0===P||null===(u=P.current)||void 0===u||null===(g=u.cropper)||void 0===g||null===(v=g.cropBoxData)||void 0===v?void 0:v.height},src:C}):(0,p.jsx)(s.Z,{cropend:function(){return U()},ref:P,src:N,zoomable:!1,autoCropArea:-.01,background:!1})}):(0,p.jsx)(d(),{audio:!1,height:300,ref:w,screenshotFormat:"image/jpeg",width:500,style:{borderRadius:5},videoConstraints:{width:519,height:400,deviceId:_}})}),(0,p.jsx)(a.Z,{display:"flex",flexDirection:"column",alignContent:"center",justifyContent:"center",children:null!==N&&void 0!==N&&N.length?(0,p.jsxs)(a.Z,{style:{display:"flex",width:"100%",flexDirection:"row",marginTop:"2rem",justifyContent:"space-between"},children:[(0,p.jsx)(h.Z,{style:{background:"#bd6100",width:"13rem"},onClick:function(){S(""),O(""),D(!1)},children:"Re-take"}),T?(0,p.jsx)(h.Z,{style:{background:"#bd6100",width:"13rem"},onClick:function(){!function(){var e,t;fetch("http://gn-testapi.tech5.tech:9090/MBAP/api/verifyBiometrics",{method:"POST",headers:{"Content-Type":"application/json"},body:null===JSON||void 0===JSON?void 0:JSON.stringify({transactionId:"b3c350aa-2734-48d1-345-7777777",transactionSource:"nxGen MBAP TestTool",uid:"111122223333555555",needTemplates:0,probeFace:{pos:"F",image:C.replace("data:image/jpeg;base64,",""),template:null,quality:0},galleryFace:{pos:"F",image:null===(e=y.userData[0])||void 0===e?void 0:e.ocr_user_image,template:null,quality:0},probeFingerData:null,galleryFingerData:null,probeIrisData:null,galleryIrisData:null,faceThreshold:"6",fingerThreshold:"6",irisThreshold:"6"})}).then((function(e){return e.json()})).then((function(e){})).catch((function(e){})),B(!0),fetch("http://gn-testapi.tech5.tech:9090/MBAP/api/verifyBiometrics",{method:"POST",headers:{"Content-Type":"application/json"},body:null===JSON||void 0===JSON?void 0:JSON.stringify({transactionId:"b3c350aa-2734-48d1-345-7777777",transactionSource:"nxGen MBAP TestTool",uid:"111122223333555555",needTemplates:0,probeFace:{pos:"F",image:C.replace("data:image/jpeg;base64,",""),template:null,quality:0},galleryFace:{pos:"F",image:null===(t=y.userData[0])||void 0===t?void 0:t.ocr_user_image,template:null,quality:0},probeFingerData:null,galleryFingerData:null,probeIrisData:null,galleryIrisData:null,faceThreshold:"6",fingerThreshold:"6",irisThreshold:"6"})}).then((function(e){return null===e||void 0===e?void 0:e.json()})).then((function(e){B(!1);var t=JSON.stringify(e);if(sessionStorage.setItem("auth",t),!0===e.verificationResult)m(f.yy.dashboard);else if(!1===e.verificationResult){var n;"Verification Failed"===(null===e||void 0===e||null===(n=e.error)||void 0===n?void 0:n.errorMessage)?c.Am.error("Authentication failed, face mismatch"):c.Am.error("No proper face is captured"),S(""),O(""),D(!1)}}))}()},children:"Continue"}):(0,p.jsx)(h.Z,{style:{background:"#bd6100",width:"13rem"},onClick:function(){O(C),D(!0)},children:"Crop"})]}):(0,p.jsxs)(a.Z,{display:"flex",gap:"2rem",children:[(0,p.jsx)(h.Z,{style:{background:"#bd6100",width:"13rem"},onClick:function(){m("/")},children:"Cancel"}),(0,p.jsx)(h.Z,{style:{background:"#bd6100",width:"13rem"},onClick:function(){V()},children:"Capture"})]})})]})})})})}}}]);
//# sourceMappingURL=333.c7ae296f.chunk.js.map